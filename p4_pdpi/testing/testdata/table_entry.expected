=========================================================================
empty PI
=========================================================================

--- PI (Input):

--- PI is invalid/unsupported:
NOT_FOUND: Key not found.; Table ID 0 does not exist in P4Info.

=========================================================================
invalid table id
=========================================================================

--- PI (Input):
table_id: 431

--- PI is invalid/unsupported:
NOT_FOUND: Key not found.; Table ID 431 does not exist in P4Info.

=========================================================================
missing matches
=========================================================================

--- PI (Input):
table_id: 33554433

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected 2 mandatory match conditions but found 0 instead.

=========================================================================
invalid match type - expect exact
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  lpm {
    value: "\377\""
    prefix_len: 24
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected exact match type in PI.

=========================================================================
invalid match type - expect lpm
=========================================================================

--- PI (Input):
table_id: 33554436
match {
  field_id: 1
  ternary {
    value: "\377\""
    mask: "\323T\022"
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected LPM match type in PI.

=========================================================================
invalid match type - expect ternary
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected ternary match type in PI.

=========================================================================
invalid match type - expect optional
=========================================================================

--- PI (Input):
table_id: 33554441
match {
  field_id: 1
  lpm {
    value: "\377\""
    prefix_len: 24
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected optional match type in PI.

=========================================================================
invalid match field id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 11
  exact {
    value: "\377\""
  }
}

--- PI is invalid/unsupported:
NOT_FOUND: Key not found.; Match Field 11 does not exist in table "id_test_table".

=========================================================================
invalid bytestring value
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 2
  exact {
    value: "\377\"CE2"
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Bytestring of length 40 bits does not fit in 32 bits.

=========================================================================
invalid prefix length
=========================================================================

--- PI (Input):
table_id: 33554436
match {
  field_id: 1
  lpm {
    value: "\377\""
    prefix_len: 40
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Prefix length 40 is greater than bitwidth 32 in LPM.

=========================================================================
duplicate match field id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 1
  exact {
    value: "\020$2R"
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Duplicate match field found with ID 1.

=========================================================================
lpm value - masked bits set
=========================================================================

--- PI (Input):
table_id: 33554436
match {
  field_id: 1
  lpm {
    value: "\020C#\022"
    prefix_len: 24
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: LPM value has masked bits that are set. Value: "\020C#\022" Prefix Length: 24

=========================================================================
ternary value too long
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "B\022"
    mask: "\377"
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Bytestring of length 15 bits does not fit in 10 bits.

=========================================================================
ternary value and mask too long
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "B\022"
    mask: "\377\377"
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Bytestring of length 15 bits does not fit in 10 bits.

=========================================================================
ternary value - masked bits set
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "\001\000"
    mask: "\000\377"
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Ternary value has masked bits that are set.
Value: \001\000 Mask: \000\377

=========================================================================
missing action
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Action missing in TableEntry with ID 33554433.

=========================================================================
invalid action
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action_profile_member_id: 12
}

--- PI is invalid/unsupported:
UNIMPLEMENTED: Unsupported action type: 2

=========================================================================
action set in table with action
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action_profile_action_set {
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\000\000\000\010"
        }
        params {
          param_id: 2
          value: "\000\000\000\t"
        }
      }
      weight: 1
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table "id_test_table" requires an action since it does not use onseshot. Got action set instead.

=========================================================================
action in table with action set
=========================================================================

--- PI (Input):
table_id: 33554438
match {
  field_id: 1
  lpm {
    value: "\377\000"
    prefix_len: 24
  }
}
action {
  action {
    action_id: 16777217
    params {
      param_id: 1
      value: "\000\000\000\010"
    }
    params {
      param_id: 2
      value: "\000\000\000\t"
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table "wcmp_table" requires an action set since it uses onseshot. Got action instead.

=========================================================================
missing action id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 1
  }
}

--- PI is invalid/unsupported:
NOT_FOUND: Key not found.; Action ID 1 does not exist in P4Info.

=========================================================================
invalid action id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 16777219
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Action ID 16777219 is not a valid action for this table.

=========================================================================
missing action params
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 16777217
    params {
      param_id: 1
      value: "T"
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected 2 parameters, but got 1 instead in action with ID 16777217.

=========================================================================
duplicate action param id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 16777217
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 1
      value: "e"
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Duplicate param field found with ID 1.

=========================================================================
invalid action param id
=========================================================================

--- PI (Input):
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 16777217
    params {
      param_id: 67
      value: "T"
    }
    params {
      param_id: 2
      value: "#"
    }
  }
}

--- PI is invalid/unsupported:
NOT_FOUND: Key not found.; Unable to find param ID 67 in action with ID 16777217

=========================================================================
zero lpm prefix length
=========================================================================

--- PI (Input):
table_id: 33554436
match {
  field_id: 1
  lpm {
    value: "\0202A\005"
  }
}
action {
  action {
    action_id: 21257015
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: A wild-card LPM match (i.e., prefix length of 0) must be represented by omitting the match altogether.

=========================================================================
zero ternary mask
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "\001\000"
    mask: "\000"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 2
      value: "#"
    }
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: A wild-card ternary match (i.e., mask of 0) must be represented by omitting the match altogether.

=========================================================================
zero priority
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "\001\000"
    mask: "\001\377"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 2
      value: "#"
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.

=========================================================================
negative priority
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "\001\000"
    mask: "\001\377"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 2
      value: "#"
    }
  }
}
priority: -32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got -32 instead.

=========================================================================
absent priority
=========================================================================

--- PI (Input):
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "\001\000"
    mask: "\001\377"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 2
      value: "#"
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.

=========================================================================
unexpected priority
=========================================================================

--- PI (Input):
table_id: 33554436
match {
  field_id: 1
  lpm {
    value: "\0202A\000"
    prefix_len: 24
  }
}
action {
  action {
    action_id: 21257015
  }
}
priority: 32

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Table entries with no ternary or optional matches cannot have a priority. Got 32 instead.

=========================================================================
action set with negative weight
=========================================================================

--- PI (Input):
table_id: 33554438
match {
  field_id: 1
  lpm {
    value: "\377\000"
    prefix_len: 24
  }
}
action {
  action_profile_action_set {
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\000\000\000\010"
        }
        params {
          param_id: 2
          value: "\000\000\000\t"
        }
      }
      weight: -1
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Expected positive action set weight, but got -1 instead.

=========================================================================
action set with invalid action
=========================================================================

--- PI (Input):
table_id: 33554438
match {
  field_id: 1
  lpm {
    value: "\377\000"
    prefix_len: 24
  }
}
action {
  action_profile_action_set {
    action_profile_actions {
      action {
        action_id: 16777218
        params {
          param_id: 1
          value: "\000\000\000\010"
        }
        params {
          param_id: 2
          value: "\000\000\000\t"
        }
      }
      weight: 1
    }
  }
}

--- PI is invalid/unsupported:
INVALID_ARGUMENT: Action ID 16777218 is not a valid action for this table.

=========================================================================
empty IR
=========================================================================

--- IR (Input):

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Table name "" does not exist in P4Info.

=========================================================================
invalid table name
=========================================================================

--- IR (Input):
table_name: "invalid"

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Table name "invalid" does not exist in P4Info.

=========================================================================
missing matches
=========================================================================

--- IR (Input):
table_name: "id_test_table"

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected 2 mandatory match conditions but found 0 instead.

=========================================================================
invalid match type - expect exact
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  lpm {
    value {
      ipv6: "::ff22"
    }
    prefix_length: 96
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected exact match type in IR table entry.

=========================================================================
invalid match type - expect optional
=========================================================================

--- IR (Input):
table_name: "optional_table"
matches {
  name: "ipv6"
  lpm {
    value {
      ipv6: "::ff22"
    }
    prefix_length: 96
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected optional match type in IR table entry.

=========================================================================
invalid match type - expect lpm
=========================================================================

--- IR (Input):
table_name: "lpm2_table"
matches {
  name: "ipv6"
  ternary {
    value {
      ipv6: "::ff22"
    }
    mask {
      ipv6: "::00d3:5412"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected LPM match type in IR table entry.

=========================================================================
invalid match type - expect ternary
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
priority: 32

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected ternary match type in IR table entry.

=========================================================================
invalid match field name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "invalid"
  exact {
    ipv6: "::ff22"
  }
}

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Match Field "invalid" does not exist in table "id_test_table".

=========================================================================
invalid IR value
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv4"
  exact {
    ipv6: "::ff22"
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected format "IPV4", but got "ipv6" instead.

=========================================================================
invalid prefix length
=========================================================================

--- IR (Input):
table_name: "lpm1_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "10.32.14.2"
    }
    prefix_length: 40
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Prefix length 40 is greater than bitwidth 32 in LPM.

=========================================================================
duplicate match field name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv6"
  exact {
    ipv4: "10.24.32.52"
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Duplicate match field found with name "ipv6".

=========================================================================
lpm value - masked bits set
=========================================================================

--- IR (Input):
table_name: "lpm1_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "10.43.23.12"
    }
    prefix_length: 24
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: LPM value has masked bits that are set.
Value: ipv4: "10.43.23.12"
Prefix Length: 24

=========================================================================
ternary value too long
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x4212"
    }
    mask {
      hex_str: "0x00ff"
    }
  }
}
priority: 32

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Bytestring of length 15 bits does not fit in 10 bits.

=========================================================================
ternary value and mask too long
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x4212"
    }
    mask {
      hex_str: "0x0fff"
    }
  }
}
priority: 32

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Bytestring of length 15 bits does not fit in 10 bits.

=========================================================================
ternary value - masked bits set
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "ipv6"
  ternary {
    value {
      ipv6: "::0100"
    }
    mask {
      ipv6: "::00ff"
    }
  }
}
priority: 32

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Ternary value has masked bits that are set.
Value: ipv6: "::0100"
Mask : ipv6: "::00ff"


=========================================================================
missing action
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Action missing in TableEntry with name "id_test_table".

=========================================================================
missing action name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action {
}

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Action "" does not exist in P4Info.

=========================================================================
invalid action name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action {
  name: "invalid"
}

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Action "invalid" does not exist in P4Info.

=========================================================================
missing action params
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected 2 parameters, but got 1 instead in action "do_thing_1".

=========================================================================
duplicate action param name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg2"
    value {
      hex_str: "0x65"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Duplicate param field found with name "arg2".

=========================================================================
invalid action param name
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Unable to find param "arg" in action "do_thing_1".

=========================================================================
action set in table with action
=========================================================================

--- IR (Input):
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.24.32.52"
  }
}
action_set {
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x10"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x11"
        }
      }
    }
    weight: 1
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table "id_test_table" requires an action since it does not use onseshot. Got action set instead.

=========================================================================
action in table with action set
=========================================================================

--- IR (Input):
table_name: "wcmp_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "34.234.42.0"
    }
    prefix_length: 24
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x10"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x11"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table "wcmp_table" requires an action set since it uses onseshot. Got action instead.

=========================================================================
zero lpm prefix length
=========================================================================

--- IR (Input):
table_name: "lpm1_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "10.32.41.5"
    }
  }
}
action {
  name: "NoAction"
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: A wild-card LPM match (i.e., prefix length of 0) must be represented by omitting the match altogether.

=========================================================================
zero ternary mask
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x0100"
    }
    mask {
      hex_str: "0x00"
    }
  }
}
priority: 32
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: A wild-card ternary match (i.e., mask of 0) must be represented by omitting the match altogether.

=========================================================================
zero priority
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x0100"
    }
    mask {
      hex_str: "0x01ff"
    }
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.

=========================================================================
negative priority
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x0100"
    }
    mask {
      hex_str: "0x01ff"
    }
  }
}
priority: -32
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got -32 instead.

=========================================================================
absent priority
=========================================================================

--- IR (Input):
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x0100"
    }
    mask {
      hex_str: "0x01ff"
    }
  }
}
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.

=========================================================================
unexpected priority
=========================================================================

--- IR (Input):
table_name: "lpm1_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "10.32.41.0"
    }
    prefix_length: 24
  }
}
priority: 32
action {
  name: "NoAction"
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Table entries with no ternary or optional matches require a zero priority. Got 32 instead.

=========================================================================
action set with negative weight
=========================================================================

--- IR (Input):
table_name: "wcmp_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "0.0.255.0"
    }
    prefix_length: 24
  }
}
action_set {
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x00000008"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x00000009"
        }
      }
    }
    weight: -1
  }
}

--- IR (converting to PI) is invalid/unsupported:
INVALID_ARGUMENT: Expected positive action set weight, but got -1 instead.

=========================================================================
action set with invalid action
=========================================================================

--- IR (Input):
table_name: "wcmp_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "0.0.255.0"
    }
    prefix_length: 24
  }
}
action_set {
  actions {
    action {
      name: "invalid_do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x00000008"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x00000009"
        }
      }
    }
    weight: -1
  }
}

--- IR (converting to PI) is invalid/unsupported:
NOT_FOUND: Key not found.; Action "invalid_do_thing_1" does not exist in P4Info.

=========================================================================
empty PD
=========================================================================

--- PD (Input):

--- PD is invalid/unsupported:
NOT_FOUND: Oneof field "entry" is not set.
=========================================================================
missing matches
=========================================================================

--- PD (Input):
id_test_table_entry {
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Expected 2 mandatory match conditions but found 0 instead.
=========================================================================
missing action
=========================================================================

--- PD (Input):
id_test_table_entry {
  match {
    ipv6: "::ff22"
    ipv4: "16.36.50.82"
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Action missing in TableEntry with name "id_test_table".
=========================================================================
exact match missing
=========================================================================

--- PD (Input):
id_test_table_entry {
  match {
    ipv6: "::ff22"
  }
  action {
    do_thing_2 {
      normal: "0x54"
      ipv4: "10.43.12.5"
      ipv6: "3242::fee2"
      mac: "00:11:22:33:44:55"
      str: "hello"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Expected 2 mandatory match conditions but found 1 instead.
=========================================================================
negative prefix length
=========================================================================

--- PD (Input):
lpm2_table_entry {
  match {
    ipv6 {
      value: "ffff::abcd:0:0"
      prefix_length: -4
    }
  }
  action {
    NoAction {
    }
  }
}

--- PD is invalid/unsupported:
INVALID_ARGUMENT: Prefix length (-4) for match field "ipv6" is out of bounds.
=========================================================================
prefix length too large
=========================================================================

--- PD (Input):
lpm2_table_entry {
  match {
    ipv6 {
      value: "ffff::abcd:0:0"
      prefix_length: 132
    }
  }
  action {
    NoAction {
    }
  }
}

--- PD is invalid/unsupported:
INVALID_ARGUMENT: Prefix length (132) for match field "ipv6" is out of bounds.
=========================================================================
zero prefix length
=========================================================================

--- PD (Input):
lpm2_table_entry {
  match {
    ipv6 {
      value: "ffff::abcd:0:0"
    }
  }
  action {
    NoAction {
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
A wild-card LPM match (i.e., prefix length of 0) must be represented by omitting the match altogether.
=========================================================================
ternary entry with zero mask
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x00"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x0251"
    }
  }
  priority: 32
}

--- PD is invalid/unsupported (detected when translating IR to PI):
A wild-card ternary match (i.e., mask of 0) must be represented by omitting the match altogether.
=========================================================================
lpm value - masked bits set
=========================================================================

--- PD (Input):
lpm2_table_entry {
  match {
    ipv6 {
      value: "ffff::abcd:0:aabb"
      prefix_length: 96
    }
  }
  action {
    NoAction {
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
LPM value has masked bits that are set.
Value: ipv6: "ffff::abcd:0:aabb"
Prefix Length: 96
=========================================================================
ternary value - masked bits set
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x01"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x0251"
    }
  }
  priority: 32
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Ternary value has masked bits that are set.
Value: hex_str: "0x52"
Mask : hex_str: "0x01"

=========================================================================
action with missing arguments
=========================================================================

--- PD (Input):
id_test_table_entry {
  match {
    ipv6: "::ff22"
    ipv4: "16.36.50.82"
  }
  action {
    do_thing_2 {
      normal: "0x54"
      mac: "00:11:22:33:44:55"
      str: "hello"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Expected 5 parameters, but got 3 instead in action "do_thing_2".
=========================================================================
action with wrong argument format
=========================================================================

--- PD (Input):
id_test_table_entry {
  match {
    ipv6: "::ff22"
    ipv4: "16.36.50.82"
  }
  action {
    do_thing_2 {
      normal: "10.23.43.1"
      ipv4: "10.43.12.5"
      ipv6: "3242::fee2"
      mac: "00:11:22:33:44:55"
      str: "hello"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
IR Value "10.23.43.1" with hex string format does not start with 0x.
=========================================================================
ternary table with zero priority
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x0273"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x0251"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.
=========================================================================
ternary table with negative priority
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x0273"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x0251"
    }
  }
  priority: -43
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Table entries with ternary or optional matches require a positive non-zero priority. Got -43 instead.
=========================================================================
ternary table with priority absent
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x0273"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x0251"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Table entries with ternary or optional matches require a positive non-zero priority. Got 0 instead.
=========================================================================
wcmp table with negative weight
=========================================================================

--- PD (Input):
wcmp_table_entry {
  match {
    ipv4 {
      value: "0.0.255.0"
      prefix_length: 24
    }
  }
  actions {
    weight: -1
    do_thing_1 {
      arg2: "0x8"
      arg1: "0x9"
    }
  }
}

--- PD is invalid/unsupported (detected when translating IR to PI):
Expected positive action set weight, but got -1 instead.
=========================================================================
valid wcmp table with choice of action
=========================================================================

--- PD (Input):
wcmp2_table_entry {
  match {
    ipv4 {
      value: "0.0.255.0"
      prefix_length: 24
    }
  }
  actions {
    weight: 1
    do_thing_1 {
      arg2: "0x8"
      arg1: "0x9"
    }
  }
  actions {
    weight: 2
    do_thing_1 {
      arg2: "0x10"
      arg1: "0x11"
    }
  }
}

--- IR:
table_name: "wcmp2_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "0.0.255.0"
    }
    prefix_length: 24
  }
}
action_set {
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x8"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x9"
        }
      }
    }
    weight: 1
  }
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x10"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x11"
        }
      }
    }
    weight: 2
  }
}

--- PI:
table_id: 33554440
match {
  field_id: 1
  lpm {
    value: "\377\000"
    prefix_len: 24
  }
}
action {
  action_profile_action_set {
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\010"
        }
        params {
          param_id: 2
          value: "\t"
        }
      }
      weight: 1
    }
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\020"
        }
        params {
          param_id: 2
          value: "\021"
        }
      }
      weight: 2
    }
  }
}


=========================================================================
valid wcmp table
=========================================================================

--- PD (Input):
wcmp_table_entry {
  match {
    ipv4 {
      value: "0.0.255.0"
      prefix_length: 24
    }
  }
  actions {
    weight: 1
    do_thing_1 {
      arg2: "0x8"
      arg1: "0x9"
    }
  }
  actions {
    weight: 2
    do_thing_1 {
      arg2: "0x10"
      arg1: "0x11"
    }
  }
}

--- IR:
table_name: "wcmp_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "0.0.255.0"
    }
    prefix_length: 24
  }
}
action_set {
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x8"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x9"
        }
      }
    }
    weight: 1
  }
  actions {
    action {
      name: "do_thing_1"
      params {
        name: "arg2"
        value {
          hex_str: "0x10"
        }
      }
      params {
        name: "arg1"
        value {
          hex_str: "0x11"
        }
      }
    }
    weight: 2
  }
}

--- PI:
table_id: 33554438
match {
  field_id: 1
  lpm {
    value: "\377\000"
    prefix_len: 24
  }
}
action {
  action_profile_action_set {
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\010"
        }
        params {
          param_id: 2
          value: "\t"
        }
      }
      weight: 1
    }
    action_profile_actions {
      action {
        action_id: 16777217
        params {
          param_id: 1
          value: "\020"
        }
        params {
          param_id: 2
          value: "\021"
        }
      }
      weight: 2
    }
  }
}


=========================================================================
exact matches of all formats
=========================================================================

--- PD (Input):
exact_table_entry {
  match {
    normal: "0x54"
    ipv4: "10.43.12.5"
    ipv6: "3242::fee2"
    mac: "00:11:22:33:44:55"
    str: "hello"
  }
  action {
    NoAction {
    }
  }
}

--- IR:
table_name: "exact_table"
matches {
  name: "normal"
  exact {
    hex_str: "0x54"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "10.43.12.5"
  }
}
matches {
  name: "ipv6"
  exact {
    ipv6: "3242::fee2"
  }
}
matches {
  name: "mac"
  exact {
    mac: "00:11:22:33:44:55"
  }
}
matches {
  name: "str"
  exact {
    str: "hello"
  }
}
action {
  name: "NoAction"
}

--- PI:
table_id: 33554434
match {
  field_id: 1
  exact {
    value: "T"
  }
}
match {
  field_id: 2
  exact {
    value: "\n+\014\005"
  }
}
match {
  field_id: 3
  exact {
    value: "2B\000\000\000\000\000\000\000\000\000\000\000\000\376\342"
  }
}
match {
  field_id: 4
  exact {
    value: "\021\"3DU"
  }
}
match {
  field_id: 5
  exact {
    value: "hello"
  }
}
action {
  action {
    action_id: 21257015
  }
}


=========================================================================
valid optional table missing a match
=========================================================================

--- PD (Input):
optional_table_entry {
  match {
    ipv6 {
      value: "3242::fee2"
    }
  }
  action {
    do_thing_1 {
      arg2: "0x10"
      arg1: "0x11"
    }
  }
  priority: 32
}

--- IR:
table_name: "optional_table"
matches {
  name: "ipv6"
  optional {
    value {
      ipv6: "3242::fee2"
    }
  }
}
priority: 32
action {
  name: "do_thing_1"
  params {
    name: "arg2"
    value {
      hex_str: "0x10"
    }
  }
  params {
    name: "arg1"
    value {
      hex_str: "0x11"
    }
  }
}

--- PI:
table_id: 33554441
match {
  field_id: 1
  optional {
    value: "2B\000\000\000\000\000\000\000\000\000\000\000\000\376\342"
  }
}
action {
  action {
    action_id: 16777217
    params {
      param_id: 1
      value: "\020"
    }
    params {
      param_id: 2
      value: "\021"
    }
  }
}
priority: 32


=========================================================================
ternary with wildcard
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x273"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x251"
    }
  }
  priority: 32
}

--- IR:
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x52"
    }
    mask {
      hex_str: "0x273"
    }
  }
}
priority: 32
action {
  name: "do_thing_3"
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
  params {
    name: "arg2"
    value {
      hex_str: "0x251"
    }
  }
}

--- PI:
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "R"
    mask: "\002s"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "#"
    }
    params {
      param_id: 2
      value: "\002Q"
    }
  }
}
priority: 32


=========================================================================
ternary table for all formats
=========================================================================

--- PD (Input):
ternary_table_entry {
  match {
    normal {
      value: "0x52"
      mask: "0x273"
    }
    ipv4 {
      value: "10.43.12.4"
      mask: "10.43.12.5"
    }
    ipv6 {
      value: "::ee66"
      mask: "::ff77"
    }
    mac {
      value: "11:22:33:44:55:66"
      mask: "33:66:77:66:77:77"
    }
  }
  action {
    do_thing_3 {
      arg1: "0x23"
      arg2: "0x251"
    }
  }
  priority: 32
}

--- IR:
table_name: "ternary_table"
matches {
  name: "normal"
  ternary {
    value {
      hex_str: "0x52"
    }
    mask {
      hex_str: "0x273"
    }
  }
}
matches {
  name: "ipv4"
  ternary {
    value {
      ipv4: "10.43.12.4"
    }
    mask {
      ipv4: "10.43.12.5"
    }
  }
}
matches {
  name: "ipv6"
  ternary {
    value {
      ipv6: "::ee66"
    }
    mask {
      ipv6: "::ff77"
    }
  }
}
matches {
  name: "mac"
  ternary {
    value {
      mac: "11:22:33:44:55:66"
    }
    mask {
      mac: "33:66:77:66:77:77"
    }
  }
}
priority: 32
action {
  name: "do_thing_3"
  params {
    name: "arg1"
    value {
      hex_str: "0x23"
    }
  }
  params {
    name: "arg2"
    value {
      hex_str: "0x251"
    }
  }
}

--- PI:
table_id: 33554435
match {
  field_id: 1
  ternary {
    value: "R"
    mask: "\002s"
  }
}
match {
  field_id: 2
  ternary {
    value: "\n+\014\004"
    mask: "\n+\014\005"
  }
}
match {
  field_id: 3
  ternary {
    value: "\356f"
    mask: "\377w"
  }
}
match {
  field_id: 4
  ternary {
    value: "\021\"3DUf"
    mask: "3fwfww"
  }
}
action {
  action {
    action_id: 16777219
    params {
      param_id: 1
      value: "#"
    }
    params {
      param_id: 2
      value: "\002Q"
    }
  }
}
priority: 32


=========================================================================
ipv4 LPM table
=========================================================================

--- PD (Input):
lpm1_table_entry {
  match {
    ipv4 {
      value: "10.43.12.0"
      prefix_length: 24
    }
  }
  action {
    NoAction {
    }
  }
}

--- IR:
table_name: "lpm1_table"
matches {
  name: "ipv4"
  lpm {
    value {
      ipv4: "10.43.12.0"
    }
    prefix_length: 24
  }
}
action {
  name: "NoAction"
}

--- PI:
table_id: 33554436
match {
  field_id: 1
  lpm {
    value: "\n+\014\000"
    prefix_len: 24
  }
}
action {
  action {
    action_id: 21257015
  }
}


=========================================================================
ipv6 LPM table
=========================================================================

--- PD (Input):
lpm2_table_entry {
  match {
    ipv6 {
      value: "ffff::abcd:0:0"
      prefix_length: 96
    }
  }
  action {
    NoAction {
    }
  }
}

--- IR:
table_name: "lpm2_table"
matches {
  name: "ipv6"
  lpm {
    value {
      ipv6: "ffff::abcd:0:0"
    }
    prefix_length: 96
  }
}
action {
  name: "NoAction"
}

--- PI:
table_id: 33554437
match {
  field_id: 1
  lpm {
    value: "\377\377\000\000\000\000\000\000\000\000\253\315\000\000\000\000"
    prefix_len: 96
  }
}
action {
  action {
    action_id: 21257015
  }
}


=========================================================================
action with all formats as arguments
=========================================================================

--- PD (Input):
id_test_table_entry {
  match {
    ipv6: "::ff22"
    ipv4: "16.36.50.82"
  }
  action {
    do_thing_2 {
      normal: "0x54"
      ipv4: "10.43.12.5"
      ipv6: "3242::fee2"
      mac: "00:11:22:33:44:55"
      str: "hello"
    }
  }
}

--- IR:
table_name: "id_test_table"
matches {
  name: "ipv6"
  exact {
    ipv6: "::ff22"
  }
}
matches {
  name: "ipv4"
  exact {
    ipv4: "16.36.50.82"
  }
}
action {
  name: "do_thing_2"
  params {
    name: "normal"
    value {
      hex_str: "0x54"
    }
  }
  params {
    name: "ipv4"
    value {
      ipv4: "10.43.12.5"
    }
  }
  params {
    name: "ipv6"
    value {
      ipv6: "3242::fee2"
    }
  }
  params {
    name: "mac"
    value {
      mac: "00:11:22:33:44:55"
    }
  }
  params {
    name: "str"
    value {
      str: "hello"
    }
  }
}

--- PI:
table_id: 33554433
match {
  field_id: 1
  exact {
    value: "\377\""
  }
}
match {
  field_id: 2
  exact {
    value: "\020$2R"
  }
}
action {
  action {
    action_id: 16777218
    params {
      param_id: 1
      value: "T"
    }
    params {
      param_id: 2
      value: "\n+\014\005"
    }
    params {
      param_id: 3
      value: "2B\000\000\000\000\000\000\000\000\000\000\000\000\376\342"
    }
    params {
      param_id: 4
      value: "\021\"3DU"
    }
    params {
      param_id: 5
      value: "hello"
    }
  }
}


